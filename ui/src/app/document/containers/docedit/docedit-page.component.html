<div fxLayout="row" class="doc-edit-container">
	<mat-card fxFlex="100" class="mat-elevation-z0">
		<mat-sidenav-container class="comment-sidenav-container" (backdropClick)="sidenav.close()">
			<mat-sidenav #sidenav (keydown.escape)="sidenav.close()" class="comment-sidenav" [position]="'end'">
				<div *ngIf="history$ | async as history">
					<med-doc-history
						[dochistory]="history"
						[selectedHistory]= "version$ | async"
						(loadVersion)="loadVersion($event)">
					</med-doc-history>
				</div>
			</mat-sidenav>

			<mat-sidenav-content class="editor-form">
				<mat-card-title>
					<i class="icon-badge icon-badge-sm fa {{(model$ | async)?.icon?.name }}" [style.background-color]="(model$ | async)?.icon?.color"></i>
					{{(model$ | async)?.name}}
				</mat-card-title>

				<mat-card-subtitle>
					{{(model$ | async)?.description}}
				</mat-card-subtitle>

				<mat-card-content>
					<div class="button-panel">
						<!-- <button mat-mini-fab
										matBadge="{{(comments$ | async)?.length}}"
										matBadgeColor="warn" (click)="sidenav.open()">
							<mat-icon>question_answer</mat-icon>
						</button> -->
						<button mat-mini-fab (click)="showDocumentHistory()">
							<mat-icon>history</mat-icon>
						</button>
					</div>							
					<med-document-edit 
						[class.readonly-doc]="!(userPrivileges$ | async).includes('edit')"
						[document]="document$ | async"
						(liveData)="liveData($event)"
						(isValid)="isValid($event)">
					</med-document-edit>
					<med-document-actions
						[canEdit]="(userPrivileges$ | async).includes('edit')"
						[canSave]="isFormValid"
						[actions]="edges$ | async" 
						(saveDocument)="saveDocument()"
						(updateState)="updateState($event)">
					</med-document-actions>	
				</mat-card-content>
			</mat-sidenav-content>
		</mat-sidenav-container>
	</mat-card>
</div>
